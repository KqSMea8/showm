# -*- coding: utf-8 -*-
import time, datetime
import requests
import re
import json
import random
from lib.util import *
from model.topic import *

SOUTH_HEADERS = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_1) '
                               'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.80 '
                               'Safari/537.36',
                 'Host': 'www.newsmth.net',
                 'Upgrade-Insecure-Requests': '1',
                 'Cookie': 'main[UTMPUSERID]=guest; main[UTMPKEY]=20949697; main[UTMPNUM]=15233; '
                           'Hm_lvt_bbac0322e6ee13093f98d5c4b5a10912=1544317497; '
                           'Hm_lpvt_bbac0322e6ee13093f98d5c4b5a10912=1544319316',
                 'Accept': '*/*',
                 'Referer': 'http://www.newsmth.net/nForum/'}


def parse_body(topic_content):
    """
    获取数据body
    :param topic_content:
    :return:
    """
    pattern = r'%s[\:：][^\<]+(\<font\s*class=\"f[\d]+\"\>[^\<]+\<\/font\>)*' \
              r'\<font\s*class=\"f[\d]+\"\>\s*\<br\s\/\>\s*\<br\s\/\>\s*' \
              r'(.*?)' \
              r'\s*\<br\s\/\>\s*<\/font>\<font\s*class=\"f[\d]+\"\>' % ('发信站', )
    p = re.compile(pattern=pattern, flags=re.I)
    tmp = p.findall(topic_content)
    print tmp[0][1]
    return tmp[0][1]


if __name__ == '__main__':
    topic_body = """发信人: Mia1024 (Mia), 信区: PieLove <br /> 标  题: 坐标北京，86年女生求遇见 <br /> 发信站: 水木社区 (Tue Sep 18 19:23:39 2018), 站内  <font class="f009">[累计积分奖励: 0/100]</font><font class="f000"> <br />  <br /> 希望不要遇见熟人，遇见了也不要暴露，会尴尬… <br />  <br /> 86，天蝎座，血型O，坐标北京，户口陕西，身高172，体重115上下飘忽，本科，网站运营（挣钱能力一般），有房，家庭和睦，无情伤 <br /> 我性格测试INFP（好奇请搜索），当然这个会随着年龄状态有些变化，助人型性格，害怕冲突 <br /> 喜欢低调内敛有趣脾气好的男生，有责任心有担当，有共同抚养孩子的意愿，有养家的能力 <br /> 不考虑的情况：有婚史，比我矮，异地，80前（目前没有相关心理建设，请见谅 <br />  <br /> 非诚勿扰，我很认真，请仔细想好再聊，谢谢！ <br />  <br /> 邮箱：xixi_lxr@163.com <br />  <br /> 今天重新做了测试，变成ENFP……性格参考日剧&lt;逃避虽可耻但有用&gt;女主 <br />  <br /> - 来自「最水木 for iPhone Xs Max」 <br /> </font><font class="f006">※ 修改:・Mia1024 于 Dec  9 21:57:32 2018 修改本文・[FROM: 223.72.65.*]</font><font class="f000"> <br /> </font><br /><a target="_blank" href="//att.newsmth.net/nForum/att/PieLove/2591667/6143"><img border="0" title="单击此查看原图" src="//att.newsmth.net/nForum/att/PieLove/2591667/6143/large" class="resizeable" /></a><div class="likes"><div class="like_name">有35位用户评价了这篇文章：</div><div class="like_list"><ul><li><span class="like_score_1">[+5]</span><span class="like_user">liuyongjun:</span><span class="like_msg">我喜欢你这种类型的。我投你呀。</span><span class="like_time">(2018-09-18 20:56)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">oldmanemil:</span><span class="like_msg">黑红配，是非分明之人，眼里一般容不得沙子</span><span class="like_time">(2018-09-19 01:10)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">oohu:</span><span class="like_msg">女神</span><span class="like_time">(2018-09-19 01:40)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">THENT:</span><span class="like_msg">加油</span><span class="like_time">(2018-09-19 03:36)</span></li><li><span class="like_score_1">[+1]</span><span class="like_user">newman11:</span><span class="like_msg">二楼怎么说黑红配？明明全身浅色衣服配个红包啊，除了头发哪里黑</span><span class="like_time">(2018-09-19 08:13)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">jjyy:</span><span class="like_msg">很漂亮</span><span class="like_time">(2018-09-19 08:49)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">yc2011:</span><span class="like_msg">大长腿</span><span class="like_time">(2018-09-19 08:49)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">jujue:</span><span class="like_msg"></span><span class="like_time">(2018-09-19 08:56)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">buybuybuy123:</span><span class="like_msg">好看</span><span class="like_time">(2018-09-19 08:57)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">wf123:</span><span class="like_msg">有共同抚养孩子的意愿。艾玛</span><span class="like_time">(2018-09-19 09:12)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">speedboy2998:</span><span class="like_msg">穿裙子看不出身材，来张牛仔裤的照片。</span><span class="like_time">(2018-09-19 09:13)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">dominer:</span><span class="like_msg">172给照出了160的感觉，拍照的跟楼主有仇</span><span class="like_time">(2018-09-19 09:13)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">ooo661:</span><span class="like_msg">拍照的人很高啊</span><span class="like_time">(2018-09-19 09:32)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">bigMAO:</span><span class="like_msg">顶楼上，确实拍照的人很高，估计是前男友？</span><span class="like_time">(2018-09-19 09:49)</span></li><li><span class="like_score_2">[-2]</span><span class="like_user">longzu2015:</span><span class="like_msg">32了，跟22交友似的。。</span><span class="like_time">(2018-09-19 09:50)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">MagicSniper:</span><span class="like_msg">同为INFP,顶</span><span class="like_time">(2018-09-19 10:10)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">calab2016:</span><span class="like_msg">竟然符合楼主大部分要求……养家能力怎么算有?</span><span class="like_time">(2018-09-19 10:24)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">flywell:</span><span class="like_msg">喜欢</span><span class="like_time">(2018-09-19 10:38)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">qiusgg:</span><span class="like_msg">好看</span><span class="like_time">(2018-09-19 10:57)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">STARMEI:</span><span class="like_msg">妹子，老衲看你奶子有点外翻啊</span><span class="like_time">(2018-09-19 10:59)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">hyy:</span><span class="like_msg"></span><span class="like_time">(2018-09-19 11:00)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">musiclive:</span><span class="like_msg">这身材我给满分</span><span class="like_time">(2018-09-19 11:35)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">liuzhlai:</span><span class="like_msg">好高</span><span class="like_time">(2018-09-19 12:08)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">zhangxg:</span><span class="like_msg">bls</span><span class="like_time">(2018-09-19 12:48)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">binghewh:</span><span class="like_msg">祝福</span><span class="like_time">(2018-09-19 12:55)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">YanXc:</span><span class="like_msg">bless</span><span class="like_time">(2018-09-19 13:45)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">shuhow:</span><span class="like_msg">同年的，我的二娃就要出来了，你还在潇洒，羡慕</span><span class="like_time">(2018-09-19 14:33)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">plough:</span><span class="like_msg">我就想问1024啥意思</span><span class="like_time">(2018-09-19 15:10)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">Daxiaoxiao:</span><span class="like_msg">好高</span><span class="like_time">(2018-09-19 15:40)</span></li><li><span class="like_score_0">[  ]</span><span class="like_user">michaelchen:</span><span class="like_msg">身材不错哦</span><span class="like_time">(2018-09-19 15:43)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">LunarSon:</span><span class="like_msg"></span><span class="like_time">(2018-09-19 17:31)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">srobinson:</span><span class="like_msg">好喜欢</span><span class="like_time">(2018-09-19 19:29)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">nklucas:</span><span class="like_msg">祝福</span><span class="like_time">(2018-10-30 08:46)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">Detachment:</span><span class="like_msg">拍照的人角度没选好，ISFJ是什么水平?</span><span class="like_time">(2018-10-31 10:00)</span></li><li><span class="like_score_1">[+5]</span><span class="like_user">dlzyy:</span><span class="like_msg">身高体重满分</span><span class="like_time">(2018-11-14 09:40)</span></li></ul></div></div>
"""
    parse_body(topic_body)
